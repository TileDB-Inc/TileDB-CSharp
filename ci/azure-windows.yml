steps:
- powershell: |
    mkdir $env:AGENT_BUILDDIRECTORY\build
    cd $env:AGENT_BUILDDIRECTORY\build
    if ($env:imageName -eq "vs2017-win2016") {
      $env:Path += ";C:\Program Files (x86)\Microsoft Visual Studio\2017\Community\Common7\IDE\CommonExtensions\Microsoft\CMake\CMake\bin"
    } else {
      Write-Host "Unknown image name: '$($env:imageName)'"
      $host.SetShouldExit(1)
    }
    cmake -G "Visual Studio 16 2019" -A x64 ..
    if ($LastExitCode -ne 0) {
      Write-Host "Build failed. CMake exit status: " $LastExitCocde
      $host.SetShouldExit($LastExitCode)
    }
    cmake --build $env:AGENT_BUILDDIRECTORY\build  -j $env:NUMBER_OF_PROCESSORS --target install --config Release
    if ($LastExitCode -ne 0) {
      Write-Host "Installation failed."
      $host.SetShouldExit($LastExitCode)
    }
  displayName: "Build_CPP"
- powershell: |
    cd $BUILD_REPOSITORY_LOCALPATH/csharp/TileDB.CSharp/TileDB.CSharp
    dotnet build /p:Platform=x64 -c Release 
  displayName: "Build_CSharp" 